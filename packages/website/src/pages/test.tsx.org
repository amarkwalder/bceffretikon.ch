import React from 'react'
import { useForm, usePlugin, useCMS } from 'tinacms'
import { InlineForm, InlineBlocks } from 'react-tinacms-inline'
import { useJsonForm } from 'gatsby-tinacms-json'

import { heroBlock } from '../components2/Hero'
import { paragraphBlock } from '../components2/Paragraph'

import data from '../../content/data.json'

export const Test: React.FC = () => {
    const cms = useCMS()

    console.log('data', data)

    const formConfig = {
        label: 'Test Page',
        id: '../../content/data.json',
        initialValues: data,
        fields: [],
        onSubmit() {
            cms.alerts.success('Saved!')
        },
    }

    const [, form] = useForm(formConfig)
    if (!form) return <></>
    usePlugin(form)

    return (
        <div className="home">
            <InlineForm form={form}>
                <InlineBlocks name="blocks" blocks={HOME_BLOCKS} />
            </InlineForm>
        </div>
    )
}

const HOME_BLOCKS = {
    hero: heroBlock,
    paragraph: paragraphBlock,
}

export default Test
